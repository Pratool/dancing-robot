<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Big Summer Blowout!</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1><a href="http://pratool.github.io/dancing-robot/">Big Summer Blowout!</a></h1>
          <h2>Software</h2>
        </header>

        <section id="toolbar" class="clearfix">
          <a href="http://pratool.github.io/dancing-robot/mechanical.html" class="button"><span style="position: relative; left: -20px">Mechanical Systems</span></a>
          <a href="http://pratool.github.io/dancing-robot/software_page.html" class="button"><span style="position: relative; left: -15px">Software Systems</span></a>
          <a href="http://pratool.github.io/dancing-robot/integration.html" class="button"><span style="position: relative; left: -20px; top: -12px">Embedded System & Integration</span></a>

<!--           <a href="https://github.com/Pratool/dancing-robot/zipball/master" id="Home" class="button"><span>Home</span></a>
          <a href="https://github.com/Pratool/dancing-robot/tarball/master" id="Overview" class="button"><span>Overview</span></a>
          <a href="https://github.com/Pratool/dancing-robot" id="Mechanical" class="button"><span>Mechanical</span></a>
          <a href="https://github.com/Pratool/dancing-robot" id="Electrical" class="button"><span>Electrical</span></a>
          <a href="https://github.com/Pratool/dancing-robot" id="Software" class="button"><span>Software</span></a>
          <a href="https://github.com/Pratool/dancing-robot" id="About" class="button"><span>About</span></a> -->
        </section>

        <hr>

        <section id="main_content">

          <h3><a id="software_bigIdea" class="anchor" href="#software_bigIdea" aria-hidden="true"><span class="octicon octicon-link"></span></a>Big Idea:</h3>

          <p>Create and use a smile detector to send information to the arduino in order to send specified set of commands to the servo to execute a dance.</p>

          <h3><a id="smile_detector" class="anchor" href="#smile_detector" aria-hidden="true"><span class="octicon octicon-link"></span></a>Smile Detector</h3>

          <h4><a id="faceMouthDetector" class="anchor" href="#faceMouthDetector" aria-hidden="true"><span class="octicon octicon-link"></span></a>Face and smile detection:</h4>

          <p>OpenCV has a library dedicated to identifying different regions of human faces and smiles. We incorporated these libraries (haar_cascade files) to create a face and mouth detector on a computer, using Python. Essentially the program takes the video feed from a webcam, runs the detector on the images, draws a square around the face and mouth regions, and shows the results in a live window. To increase the efficiency and accuracy of the mouth detector, we limited it to only analyze the images within the detected face regions.</p>

          <img src="MouthDetection.png" alt="Face and Mouth Detector" style="width:648px;height:509px">
          <p><b>Figure 1</b>: An image from the video feed of the face and mouth detector on three people</p>

          <p>This beginning iteration worked very well for our purposes and consistently delivered working results. Occasionally the program would identify faces in the background that were not there and the face detector would only detect them if the person’s face was angled directly toward the camera with some flexibility for faces that were turned slightly away from the camera, but it was working fairly consistently. Using this as a starting block, we attempted to incorporate the OpenCV smile detector. However, no matter how much testing or strategies we tried to use, we could not get it to produce any working results. For example, one of our strategies was to limit the smile detector to the area within the detected face and later to only within the mouth region, but it continued to fail. We then decided to construct our own smile detector.</p>

          <h4><a id="SD_Trained" class="anchor" href="#SD_Trained" aria-hidden="true"><span class="octicon octicon-link"></span></a>Smile detector trained:</h4>

          <p>We created a new smile classifier by using machine learning to train our computer to identify smiles.  We obtained a database of 20,000 labeled smiles from Olin Professor Paul Ruvolo and used a Python library called scikit-learn to generate a smile detection model using an algorithm called Logistic Regression. Essentially, it calculated the probability that the read image contained a smile and returned a generalized image of a smile.  When the program runs, the classifier compares the detected faces to the generalized image and calculates a log probability to determine how similar detected faces are to it.  It then returns the value which we set a threshold on for either smiling or not.  With this classifier, we were able to detect smiles reliably and produce working results.</p>

          <!--insert image-->
          <img src="MouthDetection.png" alt="Face and Mouth Detector" style="width:648px;height:509px">
          <p><b>Figure 1</b>: An image from the video feed of the face and mouth detector on three people</p>

          <h4><a id="SD_problems" class="anchor" href="#SD_problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Potential problems with smile detector:</h4>

          <p>There is some variability in the returned values. For example, although the program correctly identified when Julian and Michelle were smiling, the returned values for Michelle were consistently higher than Julian’s. Because of that, the smile detection sometimes detected smiles on Michelle when Michelle wasn’t smiling, and sometimes failed to detect smiles on Julian when Julian was smiling. This problem could be solved by adjusting the smile probability threshold for each individual, but is not a practical solution if this robot is to be used by many people. Instead we set the threshold at a value that on average detects smiles for the majority of people.</p>

          <!--insert image-->

          <p>We also found that the background and factors such as lighting affect the smile detection as well. Because of this, we decided to keep these factors constant by always using it in the same place, under the same background and lighting.</p>

          <!--talk about tuning the program when we do it-->

          <h3><a id="dances" class="anchor" href="#dances" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dances</h3>

          <p>We have three degrees of freedom for the body (swaying, heaving, and pitching) and a fourth degree for the wings (heaving). We tested out a library called VarsSpeedServo which can control up to 8 servos simultaneously. However, after some significant testing, we decided that using the Arduino Servo library would be the most efficient use of our time.</p>

          <p>There are three different dances programmed. The first executes when the penguin does not detect faces. It sways for seven counts then switches to heaving for three seconds before resetting to the swaying motion. The second dance executes when the penguin detects faces but no smiles. [insert second dance]. The third dance executes when the penguin detects a smile. To give the impression that the penguin is dancing and bouncing, we timed the swaying and heaving servos such that the body moves upward as it reaches the farthest programmed reach. As the body sways to the opposite side, it bobs down.</p>

          <h3>
          <a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

          <p>You can <a href="https://github.com/blog/821" class="user-mention">@mention</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor's GitHub Profile. For example: In 2007, Chris Wanstrath (<a href="https://github.com/defunkt" class="user-mention">@defunkt</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>




        </section>

        <footer>
          Dancing-robot is maintained by <a href="https://github.com/Pratool">Pratool</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

      </div>
    </div>
  </body>
</html>